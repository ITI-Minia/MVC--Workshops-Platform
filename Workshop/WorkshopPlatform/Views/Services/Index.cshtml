@model Workshop.ViewModel.ServicesViewModel

@{
    ViewData["Title"] = "Index";
}

<h1>Index</h1>


<table class="table">
    <thead>
        <tr>
            <th>
                Title
            </th>
            <th>
                Price
            </th>
            <th>
                Description
            </th>

            <th>
                Image
            </th>

            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in ViewBag.services)
        {
            <tr>
                <td>
                    @item.Title
                </td>
                <td>
                    @item.Price
                </td>
                <td>
                    @item.Description
                </td>

                <td>
                    <img src="~/imgs/@item.Image" style="width:124px" class="img-thumbnail" />

                </td>

                <td>
                    <a class="btn btn-primary " @*data-toggle="modal" data-target="#myUpdateModal"*@ onclick="update(@item.Id)" >
                        @*<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myUpdateModal">
                                    <input type="hidden" class="WorkShopId" value="@item.WorkShopId" />

                                Update
                            </button>*@
                        update
                    </a>

                    @*<a class="btn btn-primary updateModal " data-target="#myUpdateModal" data-toggle="updateModal">Update</a>*@
                    @*<a asp-action="Details" asp-route-id="@item.Id">Details</a>*@
                    @*<a asp-action="Delete" class="btn btn-danger">Delete</a>*@
                    @*<input type="hidden" value="@item.Id" id="serviceId"/>*@
                    <a class="btn btn-danger"  onclick="Delete(@item.Id)" data-target="#myDeleteModal" data-toggle="modal" >Delete</a>
                </td>
            </tr>
        }
    </tbody>
</table>
<div class="container">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
        Create New Service
    </button>
</div>





@*update*@
<div class="modal fade updateModal" id="myUpdateModal">
    <div class="modal-dialog">
        <div class="modal-content">

            @*Modal Header*@
            <div class="modal-header">
                <h4 class="modal-title">Update Service</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            @*Modal body*@
            <div class="modal-body">
                <form asp-action="Edit" enctype="multipart/form-data">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <input type="hidden" asp-for="Id" />

                    <div class="form-group">
                        <label asp-for="Title" class="control-label"></label>
                        <input asp-for="Title" class="form-control" />
                        <span asp-validation-for="Title" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Price" class="control-label"></label>
                        <input asp-for="Price" class="form-control" />
                        <span asp-validation-for="Price" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Description" class="control-label"></label>
                        <input asp-for="Description" class="form-control" />
                        <span asp-validation-for="Description" class="text-danger"></span>
                    </div>

                    <div class="form-group ">
                        <label asp-for="Imagepath" class="control-label">Workshop Image</label>
                        <div class="custom-file">

                            <input asp-for="Imagepath" class="form-control custom-file-input" />
                            <label class="custom-file-label">Choose Image ...</label>
                        </div>

                    </div>
                    <div class="form-group">
                        <input type="submit" value="Update" class="btn btn-primary" />
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>




@*Create*@

@*<div class="modal fade" id="myModal">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <h4 class="modal-title">create Service</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <div class="modal-body">
                <form asp-action="create"  enctype="multipart/form-data">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class="form-group">
                        <label asp-for="Title" class="control-label"></label>
                        <input asp-for="Title" class="form-control" />
                        <span asp-validation-for="Title" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Price" class="control-label"></label>
                        <input asp-for="Price" class="form-control" />
                        <span asp-validation-for="Price" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Description" class="control-label"></label>
                        <input asp-for="Description" class="form-control" />
                        <span asp-validation-for="Description" class="text-danger"></span>
                    </div>

                        <div class="form-group ">
                            <label asp-for="Image" class="control-label"></label>
                            <div class="custom-file">

                                <input asp-for="Imagepath" class="form-control custom-file-input" />
                                <label class="custom-file-label">Choose Image ...</label>
                            </div>

                        </div>

                    <br />
                    <br />
                    <div class="form-group">
                        <input type="submit" value="Create" class="btn btn-primary" />
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>*@
@*<partial name="Edit.cshtml" />*@


@*Delete*@


<div class="modal fade" id="myDeleteModal">
    <div class="modal-dialog">
        <div class="modal-content">

            @*Modal Header*@
            <div class="modal-header">
                <h4 class="modal-title">Delete Service</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            @*Modal body*@
            <div class="modal-body">
                <form method="post">
                    Are You Sure You Want To Delete This Service
                    <div class="form-group">
                        @*<input type="hidden"  id="serviceId"/>*@

                        <input type="submit" value="Delete" class="btn btn-danger" onclick="confirmDelete()" />
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
@*<partial name="Edit.cshtml">*@
@section Scripts {

    @*<script src="~/lib/jquery/dist/jquery.js"></script>
    <script src="~/lib/twitter-bootstrap/js/bootstrap.js"></script>*@
    @*<script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
        <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>*@
    <script>
        //$(document).ready(function () {
        //    $("btnSave").click(function () {
        //        var ServiceFormData = $("ServiceForm").serialize();

        //        $.ajax({
        //            type: "post",
        //            url:"/Services/Create"
        //        })
        //    })
        //})
        function cr() {
            var id = url.substring(url.lastIndexOf('/') + 1);
            WorkShopId = id;
            $.ajax({
                url: "/Services/Create",
                type: "post",

                data: WorkShopId,
                //dataType: "html",
                success: function (res) {
                    //$("#myModal2").html(res);
                    //$(".modal").modal("show");
                    //$("#myModal").modal("hide");
                    //$("#myModal3").modal("hide");

                }
                ,
                error: function (err) {
                    console.log(err);
                }
            });
        }

        function update(id) {
            //var ide = id;

            $.ajax({
                type: "Get",
                url: "/Services/Edit",
                data: { id },
                dataType: "html",
                success: function (res) {
                    //var qqq = $(this).closest('.modal');
                    $("#myUpdateModal").html(res);
                    //$(".modal").modal();
                    $(".modal").modal("show");

                    debugger;
                    //$('#myModal .close').click();
                    //$('#myModal').modal('hide');
                    //$("#myDeleteModal").modal("hide");

                    //$('.modal').modal('show');
                    //$("#myModal").modal("hide");
                    //$("#myModal").css("visibility", "hidden");

                    //$(qqq).modal('hide');
                    console.log(id);
                    //$(".modal").modal("show");
                    //$("#myModal").modal("hide");
                    //$("#myModal3").modal("hide");
                }
            });
        }
        var delid;
        function Delete(id) {
            //var ide = id;
            //delid = id;
            //console.log(delid);
            //$.ajax({
            //    type: "Get",
            //    url: "/Services/Delete",
            //    data: { id },
            //    dataType: "html",
            //    success: function (res) {

            //        $("#myDeleteModal").modal("show");

            //    }
            //});

            return id;
        }
        function confirmDelete() {
            //var id = $(this).parent.find('#serviceId').val();
            var id = Delete();
            console.log(id);
        }

        function sendId(id) {
            console.log(id);
        }
    </script>
}